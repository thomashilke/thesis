% introduction: dans cette section, on introduit le problème de Stefan
%  pour une particule isolée dans un bain électrolytique infini
Dans cette section nous détaillons et étudions numériquement les
phénomènes physiques qui sont responsables du temps de latence
préalable au début de la dissolution des grains d'alumine dans le bain
électrolytique. Dans ce but, on considère un modèle de Stefan pour
traiter le problème de la transition de phase dans le bain
électrolytique environnant une région de bain solidifiée. Pour
approcher numériquement l'évolution de la région de transition de
phase autour de la particule de bain, on fera l'hypothèse d'une
symétrique sphérique de la solution.

Commençons par remarquer que la chaleur spécifique $\aluminahc$ de
l'alumine solide et sa densité $\aluminadensity$ conduit à une
capacité thermique massique $\aluminadensity\aluminahc$ presque égale
à celle du bain électrolytique
$\electrolytedensity\electrolytehc$. L'écart entre ces deux capacités
thermiques étant de \num{32}\% seulement, nous remplacerons les
caractéristiques thermiques de l'alumine solide par celle du bain
électrolytique pour simplifier le modèle de solidification et
liquéfaction dudit bain autour d'une particule d'alumine solide
injectée dans ce bain.

% Choix des parametre thermiques constants dans chaque phase
Ce choix se justifie par le fait que ces valeurs varient peu sur
l'intervalle de température qui nous intéresse, et on peut se
contenter de considérer une valeur moyenne sur cet intervalle.

% description du système: particule et bain, symétrie sphérique,
%  caractérisation des matériaux.
\paragraph{Un modèle thermique avec transition de phase}
On considère une particule sphérique, placée à l'origine du système de
coordonnées, de température initiale $\tinj<\tliq$, où $\tliq$ est la
température du liquidus de l'électrolyte. Cette sphère est donc gelée,
c'est-à-dire sous forme solide. Le reste de l'espace est occupé par le
bain électrolytique à l'état liquide, au repos, et de température
initiale $\tinit > \tliq$.

On s'intéresse à l'évolution de la température au cours du temps dans
le système formé par la particule et le bain liquide environnant. En
particulier, la température de la particule étant inférieure à la
température du liquidus $\tliq$, le bain au voisinage de la surface de
la particule va commencer par geler. Puis, la température du système
s'équilibrant par diffusion thermique, cette couche de bain va peu à
peu fondre. On cherche à déterminer l'évolution au cours du temps de
l'épaisseur de cette couche de bain gelée.

% modèle mathématique: définitions des domaines, front de transition
%  de phase, problème de la chaleur dans chaque phase, condition de Stefan, formulation
%  forte, conditions aux limites.
On introduit maintenant le cadre nécessaire à l'écriture d'un modèle
mathématique qui décrive l'évolution thermique de la particule et du
bain.

Soit $\Omega\subset \mathbb R^3$ un domaine ouvert occupé par du bain
électrolytique. On note $\temperature(t, x)$ la température de
l'électrolyte au point $x \in \Omega$ et à l'instant $t > 0$.

Soient $\Omega_1(t)\subset \Omega$ le domaine occupé par l'électrolyte
dans la phase solide, $\Omega_2(t)\subset \Omega$ le domaine occupé
par l'électrolyte dans la phase liquide et $\Gamma(t) \subset \Omega$
la région de transition de phase définis par:
\begin{align}\label{eq:phase-domains}
  &\Omega_1(t) = \cparent{x\in\Omega \mid %
                         \temperature(t, x) < \tliq},\\
  &\Omega_2(t) = \cparent{x\in\Omega \mid \temperature(t, x) %
    > \tliq},\\
  &\Gamma(t) = \cparent{x\in\Omega\mid \temperature(t, x) = \tliq}
\end{align}

Soit $\electrolytedensity$ la densité du bain que l'on suppose
constante. Soient $\electrolytehc$, $\electrolytetdiff$ la chaleur
spécifique le coefficient de diffusion thermique du bain,
respectivement. Dans la suite, on fera l'hypothèse que les paramètres
$\electrolytehc$ et $\electrolytetdiff$ sont des fonctions de la
température $\temperature$, mais constants dans chaque phase,
c'est-à-dire que
\begin{equation}
  \electrolytehc(\temperature) = \left\{
  \begin{array}{ll}
    \electrolyteshc, & \text{ si } \temperature < \tliq,\\
    \electrolytelhc, & \text{ si } \temperature > \tliq,
  \end{array}
  \right.
  \quad\text{et}\quad
  \electrolytetdiff(\temperature) = \left\{
  \begin{array}{ll}
    \electrolytestdiff, & \text{ si } \temperature < \tliq,\\
    \electrolyteltdiff, & \text{ si } \temperature > \tliq,
  \end{array}
  \right.
\end{equation}
où $\electrolyteshc$, $\electrolytelhc$, $\electrolytestdiff$,
$\electrolyteltdiff$ sont des réels positifs donnés.

La température de l'électrolyte $\temperature$ satisfait une équation
de la chaleur dans chaque phase:
\begin{align}
  &\electrolytedensity\electrolyteshc \frac{\partial
    \temperature}{\partial t} - \electrolytestdiff \Delta\temperature
  = 0, & \forall x \in \Omega_1(t),\ \forall t\in [0,\infty),\label{eq:heat-solid-phase}\\
    %
    &\electrolytedensity\electrolytelhc \frac{\partial
    \temperature}{\partial t} - \electrolyteltdiff \Delta\temperature
  = 0, & \forall x \in \Omega_2(t),\ \forall t\in [0,\infty).\label{eq:heat-liquid-phase}
\end{align}
Soit $\nu$ la normale unité à l'interface $\Gamma$ dirigée vers
$\Omega_2$. Pour toute fonction $g:\Omega_1\cap\Omega_2\to\mathbb R$,
on note $\jump{g}:\Gamma\to\mathbb R$ le saut de la fonction $g$ sur
l'interface $\Gamma$ défini par:
\begin{equation}
  \jump{g}(x) = \lim_{\epsilon\to 0}g(x + \epsilon\nu) - g(x -
  \epsilon\nu) \quad \text{ sur } \Gamma.
\end{equation}

On suppose que l'interface entre les phases liquide est solide
satisfait la condition de Stefan. On note $v_\Gamma(t, x)$ la vitesse
de l'interface $\Gamma(t)$. La condition de Stefan pour l'interface
$\Gamma(t)$ s'écrit alors:
\begin{equation}
  \jump{\electrolytetdiff\nabla\temperature \cdot \nu} %
  = - \fusionenthalpy v_\Gamma,
  \label{eq:stefan-condition}
\end{equation}
où $\fusionenthalpy$ est la est l'enthalpie par unité de volume
libérée lors de la transition de la phase solide à liquide du
bain électrolytique.

La condition (\ref{eq:stefan-condition}) correspond à un bilan
d'énergie thermique au niveau de l'interface entre les phases. Le
membre de gauche de la relation (\ref{eq:stefan-condition}) correspond
à la quantité d'énergie absorbée ou libérée par le déplacement du
front de solidification, tandis que le membre de droite correspond à
la somme des flux d'énergie thermique au niveau du front de
solidification.

% subdivision du bord, conditions aux limites
On suppose donnée une subdivision $\Gamma_\mathrm{N}$,
$\Gamma_\mathrm{D}\subset \partial \Omega$ telle que
$\Gamma_\mathrm{N}\cap \Gamma_\mathrm{D} = \emptyset$ et
$\Gamma_\mathrm{N}\cup \Gamma_\mathrm{D} = \partial \Omega$, et les
fonctions $\temperature_\mathrm{D}:\Gamma_\mathrm{D}\to\mathbb R$ et
$\temperature_\mathrm{N}:\Gamma_\mathrm{N}\to\mathbb R$.

La partie du bord $\Gamma_\mathrm{N}$ correspond aux conditions au
limites de Neumann, tandis que sur la partie du bord
$\Gamma_\mathrm{D}$ correspond aux conditions aux limites de
Dirichlet. Les équations (\ref{eq:heat-solid-phase}),
(\ref{eq:stefan-condition}) sont complétées par les conditions aux
limites:
\begin{align}
  &\temperature(t, x) = \tliq, %
  &\forall x \in \Gamma(t),\ \forall t \in [0,\infty),\label{eq:heat-transition}\\
    %
  &\temperature(t, x) = \temperature_\mathrm{D}(x), %
  &\forall x \in \Gamma_\mathrm{D}(t),\ \forall t \in [0,\infty),\label{eq:heat-dirichlet}\\
    %
  &\frac{\partial \temperature}{\partial \nu}(t, x) = \temperature_\mathrm{N}(x), %
  &\forall x \in \Gamma_\mathrm{N}(t),\ \forall t \in [0,\infty),\label{eq:heat-neumann}
\end{align}
ainsi que par une condition initiale $\tinit$ appropriée à $t = 0$ pour
$\temperature$.

Le problème de Stefan classique consiste à chercher une fonction
$\temperature:[0,\infty)\times\Omega\to\mathbb R$ et deux
  sous-domaines $\Omega_1,\Omega_2$ qui satisfasse les équations
  (\ref{eq:phase-domains}) et
  (\ref{eq:heat-solid-phase})-(\ref{eq:stefan-condition}).

Le lecteur intéressé trouvera une discussion détaillée des différentes
formulations des problèmes de Stefan et de leurs analyses
mathématiques dans l'ouvrage de J. Hill \cite{HillStefanProblems},
ainsi que celui de L. I. Rubenstein \cite{Rubenstein1971}, par
exemple.

\paragraph{Formulation faible du problème de Stefan}
On donne maintenant une forme alternative du problème de Stefan
classique formé par les équations
(\ref{eq:heat-solid-phase})-(\ref{eq:heat-neumann}). Cette
formulation, qu'on qualifie d'{\em enthalpique},
remplace le problème de frontière libre du problème de Stefan
classique par un problème parabolique non-linéaire dégénéré. L'un des
avantages et de ne pas avoir à suivre explicitement l'interface
$\Gamma$.L'interface $\Gamma$ est obtenue après calcul par un
``post-processing''.

Soit $f_s(\temperature)$ la fraction solide du bain électrolytique. La
fraction solide est définie par:
\begin{equation}
  f_s(\temperature) = \left\{
  \begin{array}{ll}
    0           & \text{ si } \temperature \geq \tliq,\\
    1           & \text{ si } \temperature < \tliq.
  \end{array}
  \right.
\end{equation}
Le comportement de la fonction $f_s$ au voisinage de $\tliq$ est
représenté sur le graphique de gauche de la figure
\ref{fig:solid-fraction-enthalpy}.

\begin{figure}
  \begin{center}
    \input{../media/particles/solidfraction/solidfraction.tex}
    \input{../media/particles/enthalpy/enthalpy.tex}
    \caption{Gauche: fraction solide du bain $f_s$ en fonction de la
      température. Droite: Enthalpie du bain électrolytique en
      fonction de la température.}
    \label{fig:solid-fraction-enthalpy}
  \end{center}
\end{figure}

Les propriétés thermiques du bain électrolytique sont
caractérisées par la relation entre la température $\temperature$ et
l'enthalpie par unité de masse $\enthalpy$ qui s'exprime de la manière
suivante:
\begin{equation}
  \enthalpy(\temperature) = %
    \int_0^\temperature
      \electrolytedensity\electrolytehc\intd{s} %
    + \fusionenthalpy(1 - f_s(\temperature)),
\end{equation}
où $\electrolytedensity$ est la densité du bain, $\fusionenthalpy$ est
l'enthalpie de transition de phase par unité de volume, et $f_s$ la
fraction solide du bain en fonction de la température.

Le graphique de droite sur la figure \ref{fig:solid-fraction-enthalpy}
représente le comportement de la fonction $\enthalpy(\temperature)$ au
voisinage de la température de transition $\tliq$. La densité de
l'électrolyte $\electrolytedensity$ est supposée constante pour tout
$\temperature$. En particulier, on suppose que la transition entre les
phases solide et liquide à $\electrolytedensity$ constant.

Bien que la fonction $\enthalpy$ présente une discontinuité en
$\temperature = \tliq$, elle est strictement monotone, et on peut
définir une fonction $\beta(\enthalpy)$ telle que
$\beta(\enthalpy(\temperature)) = \temperature$ pour tout
$\temperature$ de la manière suivante:
\begin{equation}\label{eq:beta}
  \beta(\enthalpy) = \left\{
  \begin{array}{ll}
    \frac{\enthalpy}{\electrolytehc\electrolytedensity} %
      & \enthalpy < \tliq \electrolytehc\electrolytedensity,\\
    \tliq %
      & \tliq \electrolytehc\electrolytedensity < \enthalpy < \tliq \electrolytehc\electrolytedensity + \fusionenthalpy,\\
    \frac{\enthalpy - \fusionenthalpy}{\electrolytehc\electrolytedensity} %
      & \tliq\electrolytehc\electrolytedensity + \fusionenthalpy < \enthalpy.\\
  \end{array}
  \right.
\end{equation}
La fonction $\beta$ est représentée sur la figure \ref{fig:beta}. Pour
les besoins de la représentation, on a choisi ici $\tliq = 1218\si{\kelvin}$.
\begin{figure}
  \begin{center}
    \input{../media/particles/beta/beta.tex}
    \caption{Fonction $\beta(\enthalpy)$. On a noté $H_1 =
      \tliq\electrolyteshc\electrolytedensity$ et $H_2 =
      \tliq\electrolyteshc\electrolytedensity + \fusionenthalpy$, et
      $\tliq = 1218\si{\kelvin}$.}
    \label{fig:beta}
  \end{center}
\end{figure}

La formulation enthalpique du problème de Stefan consiste à chercher
une paire de fonctions
$\temperature,\enthalpydensity:[0,\infty)\times\Omega\to\mathbb R$
telles que:
\begin{align}
  & \frac{\partial \enthalpydensity}{\partial t} %
  - \div\parent{ \nabla \temperature} = 0,%
  & \forall (t, x) \in [0,\infty)\times
    \Omega,\label{eq:heat-one-phase}\\
  & \temperature = \beta(\enthalpydensity),
    &\forall (t, x) \in [0,\infty)\times,\label{eq:heat-temperature-enthalpy}\\
  & \temperature = \temperature_\mathrm{D}, %
  & \forall (t, x) \in [0,\infty)\times \Gamma_\mathrm{D},\label{eq:heat-one-phase-dirichlet}\\
  & \frac{\partial \temperature}{\partial \nu} = \temperature_\mathrm{N}, %
  & \forall (t, x) \in [0,\infty)\times \Gamma_\mathrm{N},\label{eq:heat-one-phase-neumann}\\
  & \temperature(0, x) = \tinit(x),
  & \forall x\in\Gamma,\label{eq:heat-initial-condition}
\end{align}
Les fonctions $\tinit$, $\temperature_\mathrm{D}$ et
$\temperature_\mathrm{N}$ ont été définies au paragraphe précédent, et
$\beta$ est définie par la relation (\ref{eq:beta}). L'équation
(\ref{eq:heat-one-phase}) est à comprendre au sens faible.

%%Étant donnée une fonction $\enthalpydensity$ qui satisfait les
%%équations (\ref{eq:heat-one-phase})-(\ref{eq:heat-one-phase-neumann}),
%%la température $\temperature$ est définie par la relation
%%$\temperature(t, x) = \beta(\enthalpydensity(t, x))$ $\forall (t, x)
%%\in [0,\infty)\times\Omega$. Finalement les domaines $\Omega_1(t)$,
%%  $\Omega_2(t)$ occupés par les phases solide et liquides et la région
%%  de transition de phase $\Gamma(t)$ sont définis par les relations
%%  (\ref{eq:phase-domains}) et (\ref{eq:phase-frontier}).

%%Étant données les fonctions $\enthalpydensity$, $\temperature$
%%solutions du problème
%%(\ref{eq:heat-one-phase})-(\ref{eq:heat-initial-condition}), les
%%phases solide $\Omega_1(t)$ et liquide $\Omega_2(t)$ sont définies par
%%la relation (\ref{eq:phase-domains}). La région de transition de phase
%%est définie par la relation (\ref{eq:phase-frontier}).

Plus précisément, on peut montrer que si $\enthalpydensity$ et
$\temperature$ sont solutions faibles de
(\ref{eq:heat-one-phase})-(\ref{eq:heat-temperature-enthalpy}) et si
$\enthalpydensity$ et $\temperature$ sont suffisamment régulières
dans $\Omega_1(t)$ et $\Omega_2(t)$ définis par
(\ref{eq:phase-domains}), alors $\temperature$ satisfait
(\ref{eq:heat-solid-phase}), (\ref{eq:heat-liquid-phase}) et (\ref{eq:stefan-condition}).

%%Si $\temperature$ est suffisamment régulière dans $\Omega$, alors la
%%condition (\ref{eq:temperature-condition}) ainsi que les équations
%%(\ref{eq:heat-solid-phase}), (\ref{eq:heat-liquid-phase}) sont
%%satisfaites par $\temperature$. On montre finalement que la
%%température $\temperature$ satisfait la condition de Stefan
%%(\ref{eq:stefan-condition}).

En effet, soit $\Lambda = [0, \infty)\times \Omega$, soit
\begin{align}
  & \Lambda_1 = \cparent{(t, x)\in\Lambda\mid x \in \Omega_1(t)},\\
  & \Lambda_2 = \cparent{(t, x)\in\Lambda\mid x \in \Omega_2(t)},\\
\end{align}
et soit $\Gamma_{tx}$ dans l'espace-temps:
\begin{equation}
  \Gamma_{tx} = \cparent{(t, x) \in \Lambda\mid x \in \Gamma(t)}.
\end{equation}
Soit $\nu_{tx}$ la normale unité à $\Gamma_{tx}$, on note $\nu_t$,
$\nu_x$ les composantes temporelles et spatiales de $\nu_{tx}$, \ie,
$\nu_{tx} = (\nu_t, \nu_x)^t$. Soit $\enthalpydensity$, $\temperature$
solutions faibles du problème de Stefan
(\ref{eq:heat-one-phase})-(\ref{eq:heat-temperature-enthalpy}). On
note le $v = (\enthalpydensity, -\electrolytetdiff\nabla
\temperature)^t$. L'équation (\ref{eq:heat-one-phase}) s'écrit donc:
\begin{equation}\label{eq:space-time-divergence}
  \Div v = 0 \quad\text{ dans }\Lambda,
\end{equation}
où $\Div = (\frac{\partial}{\partial t}, \nabla)$.



%%Au sens faible,
%%l'équation (\ref{eq:space-time-divergence}) s'écrit:
%%\begin{equation}\label{eq:one-phase-weak-space-time}
%%  \int_\Lambda v\cdot \nabla g\,\intd{x}\intd{t} = 0, \quad \forall g\in C^\infty_0(\Lambda),
%%\end{equation}
%%où $C^\infty_0(\Lambda)$ et l'ensemble des fonctions infiniment
%%dérivables à support compact et nulles sur le bord $\partial\Lambda$.
%%En supposant que $\enthalpydensity$ et $\temperature$ sont suffisamment
%%régulière sur $\Lambda_1$ et $\Lambda_2$ et en utilisant le
%%théorème de la divergence dans l'espace-temps, l'intégrale
%%(\ref{eq:one-phase-weak-space-time}) se réécrit:
%%\begin{equation}\label{eq:one-phase-space-time}
%%  -\int_{\Lambda_1} \div v g\,\intd{x}\intd{t} + \int_{\partial \Lambda_1}gv\cdot \nu_1\intd{\sigma}
%%  - \int_{\Lambda_2}\div v g\,\intd{x}\intd{t} + \int_{\partial \Lambda_2}gv\cdot \nu_2\intd{\sigma}
%%  = 0, \quad \forall g\in C^\infty_0(\Lambda).
%%\end{equation}
%%
%%En choisissant la fonction test $g$ telle que $\supp(g) \subset
%%\Lambda_1$ ou $\supp(g)\subset \Lambda_2$, on déduit que les restrictions de
%%$\temperature$ aux domaines $\Lambda_1$ et $\Lambda_2$ satisfont les
%%équations (\ref{eq:heat-solid-phase}), (\ref{eq:heat-liquid-phase}) au
%%sens fort.
%%
%%On choisit maintenant $g$ telle que $\supp(g)\subset \Lambda$, $\supp
%%g\cap\Gamma_{xy} \neq\emptyset$. Puisque seule l'intégrale sur
%%l'interface $\Gamma_{tx}$ subsiste, et que $\nu_1 = -\nu_2$ sur $\Gamma_{tx}$, l'expression
%%(\ref{eq:one-phase-space-time}) se réduit à:
%%\begin{equation}
%%\int_{\Gamma_{tx}} g\jump{v}\cdot \nu_1\intd{\sigma} = 0.
%%\end{equation}
%%On a donc $\jump{v}\cdot \nu_1 = 0$ sur tout $\Gamma_{tx}$, c'est-à-dire
%%que:
%%\begin{align}
%%  &\jump{\enthalpydensity}\nu_t = - \jump{\nabla \beta(\enthalpydensity)}\nu_x,\\
%%  \Rightarrow &\jump{\enthalpydensity}\frac{\nu_t}{\abs{\nu_x}} = - \jump{\nabla \beta(\enthalpydensity)}\frac{\nu_x}{\abs{\nu_x}}.\\
%%\end{align}
%%Puisque $\frac{\nu_t}{\abs{\nu_x}} = v_\Gamma$,
%%$\frac{\nu_x}{\abs{\nu_x}}$ est la normale unité à l'interface
%%$\Gamma(t)$ et $\jump{\enthalpydensity} = \fusionenthalpy$, on retrouve
%%bien la condition de Stefan (\ref{eq:stefan-condition}).

Le lecteur intéressé par les aspects fonctionnels liés à cette
équivalence peut consulter le travail de travail de thèse de
P.-A. Gremaud \cite{Gremaud1991}, ou l'ouvrage de J. Hill
\cite{HillStefanProblems}.\footnote{Ou plutôt le livre rouge, sur
l'étagère en bas au fond à droite de la bibliothèque de
mathématique...}

% discrétisation: symétrie sphérique ou plane, discrétisation en temps,
%  discrétisation en espace.
\paragraph{Schéma de discrétisation en temps}
Pour obtenir un schéma de discrétisation en temps du problème de
Stefan, on part de la formulation enthalpique
(\ref{eq:heat-one-phase})-(\ref{eq:heat-one-phase-neumann}), et on
suit le travail de M. Paolini et al. \cite{Paolini1988}.

Soit un temps final $T > 0$, $N\in \mathbb \nstar$ le nombre de pas de
temps. Soit $\tau = T / N$ le pas de temps et $t^n = \tau n$. On note
$L_\beta$ la constante de Lipschitz de la fonction $\beta$:
\begin{equation}
  L_\beta = \sup_{\enthalpy}\abs{\beta'(\enthalpy)}.
\end{equation}
Soit $\mu$ un paramètre de relaxation fixé, tel que $0 < \mu \leq
1/L_\beta$.

On note $\temperature^n(x)$ et $\enthalpydensity^n(x)$ les approximation
de $\temperature(t^n, x)$ et $\enthalpydensity(t^n, x)\ \forall x\in
\Omega$.  On suppose donnée la densité d'enthalpie initiale $h^0$, et
on pose $\temperature^0 = \tinit$, $\enthalpydensity^0 = \enthalpy(\tinit)$,
avec $\enthalpy$ donnée par (\ref{eq:}). Pour $0 < n \leq N$, on résout
successivement les équations:
\begin{align}
  &\temperature^{n+1} - \frac{\tau}{\mu} \div\parent{
    \electrolytetdiff \nabla\temperature^{n+1}} = %
  \beta\parent{\enthalpydensity^n}, & \text{dans } \Omega,\label{eq:chernoff-heat}\\
  &\temperature^{n+1}(x) = \temperature_{\mathrm D}(t^{n+1}, x), &
  \forall x\in%
  \Gamma_\mathrm{D},\label{eq:chernoff-dirichlet}\\
  &\frac{\partial\temperature^{n+1}}{\partial \nu}(x) = %
  \temperature_\mathrm{N}(t^{n+1}, x), %
  & \forall x \in \Gamma_\mathrm{N},\label{eq:chernoff-neumann}
\end{align}
avec la correction pour la densité d'enthalpie à chaque pas de temps:
\begin{equation}\label{eq:chernoff-update}
\enthalpydensity^{n+1} = \enthalpydensity^{n} +
\mu\parent{\temperature^{n+1} - \beta(\enthalpydensity^{n})}, \quad
\text{dans } \Omega.
\end{equation}

Ce schéma numérique basé sur la formule de Chernoff
(\ref{eq:chernoff-update}) a été proposé en premier par M. Paolini
\cite{Paolini1988}. On décrit maintenant la discrétisation en
espace des équations (\ref{eq:chernoff-heat})-(\ref{eq:chernoff-neumann}).


\paragraph{Formulation du schéma de Chernoff en coordonnées sphériques}
La formulation faible du système d'équations
(\ref{eq:chernoff-heat})-(\ref{eq:chernoff-neumann}) consiste $\forall
n\leq N$ à chercher une fonction $\temperature^{n+1}:\Omega\to\mathbb R$
à telle que la relation:
\begin{equation}\label{eq:weak-form-cart-coord}
  \int_\Omega \temperature^{n+1} v\,\intd{x} + \frac{\tau}{\mu} %
  \int_\Omega \nabla \temperature^{n+1} \nabla v\,\intd{x} - %
  \int_{\Gamma_\mathrm{N}} \temperature^{n+1}_\mathrm{N} v\,\intd{\sigma} %
  = \int_\Omega \beta(\enthalpydensity^n)v\,\intd{x}
\end{equation}
soit vérifiée pour toute fonction test $v:\Omega\to\mathbb R$ à
symétrie sphérique.

On tire parti de la symétrie sphérique du système formé par la
particule et le bain environnant en reformulant maintenant le
problème (\ref{eq:weak-form-cart-coord}) en coordonnées sphériques.

Soit $\Phi:[0,\infty)\times[0,2\pi)\times[0,\pi)\to\mathbb R^3$ le
changement de variable de coordonnées sphériques en coordonnées
cartésiennes défini par:
\begin{equation}
  \Phi(r, \psi, \phi) = \begin{pmatrix}
    r\cos\psi\sin\phi\\
    r\sin\psi\sin\phi\\
    r\cos\phi
  \end{pmatrix},
\end{equation}
dont le jacobien de $\Phi$ est donné par:
\begin{equation}\label{eq:spherical-jacobian}
  \det J_\Phi(r, \psi,\phi) = -r^2\sin\phi.
\end{equation}
On note $\hat e_r$, $\hat e_\psi$ et $\hat e_\phi$ les vecteurs de la
base standard orthonormée associée au système de coordonnée sphérique.

On dit qu'une fonction $f:\mathbb R^3\to\mathbb R$ est à symétrie
sphérique s'il existe une fonction $\tilde f:\mathbb
\rplus\to\mathbb R$ telle que
\begin{equation}\label{eq:spherical-symmetry}
  \tilde f\parent{\sqrt{x_1^2 + x_2^2 + x_3^2}} = f(x_1, x_2,
  x_3)\quad \forall(x_1, x_2,x_3)\in\mathbb R^3.
\end{equation}
Le gradient de la fonctions $f$ en coordonnées sphérique s'écrit selon
$\tilde f$:
\begin{equation}\label{eq:spherical-gradient}
  \tilde\nabla\tilde f = \frac{\mathrm d\tilde f}{\mathrm dr}\hat e_r.
\end{equation}

On se donne un réel $\rmax > 0$ et le domaine $\Omega = \mathcal B(0,
\rmax) \subset \mathbb R^3$ la boule ouverte de centre $0$ de rayon
$\rmax$. On suppose maintenant que les données du problème de Stefan
(\ref{eq:heat-one-phase})-(\ref{eq:heat-one-phase-neumann}), \ie, les
fonctions $\temperature_\mathrm{D}$, $\temperature_\mathrm{N}$ ainsi
que la condition initiale $\tinit$ pour la température, sont à
symétrie sphérique, c'est-à-dire qu'il existe des fonctions $\tilde
\temperature_\mathrm{D}$, $\tilde\temperature_\mathrm{N}$ et $\tinitr$
telles que définies par la relation (\ref{eq:spherical-symmetry}).

Sous ces hypothèses, on cherche une solution au problème de Stefan
(\ref{eq:heat-one-phase})-(\ref{eq:heat-one-phase-neumann}) en
utilisant le schéma de Chernoff
(\ref{eq:chernoff-heat})-(\ref{eq:chernoff-update}) qui soit également
à symétrie sphérique.

La subdivision du bord $\Gamma_\mathrm{D}$, $\Gamma_\mathrm{N}$ doit
également satisfaire la condition de symétrie sphérique. On distingue alors les
deux seuls cas possibles:
soit le bord de Dirichlet $\Gamma_\mathrm{D} = \partial\mathcal
B(0,\rmax)$, soit le bord de Neumann $\Gamma_\mathrm{N} =
\partial\mathcal B(0,\rmax)$.

Dans le premier cas, la formulation faible de l'équation
(\ref{eq:weak-form-cart-coord}) en coordonnées sphériques consiste à
chercher une fonction $\tilde \temperature^{n+1}:[0,\rmax] \to \mathbb
R$, $\tilde\temperature^{n+1}(\rmax) =
\tilde\temperature_{\mathrm{D}}^{n+1}$ telle que:
\begin{multline}\label{eq:weak-form-spher-coord-dirichlet}
  4\pi\int_0^{\rmax} \tilde \temperature^{n+1}\tilde v r^2\,\intd{r}
  + \frac{4\pi\tau}{\mu}\int_0^{\rmax} \frac{\mathrm d %
    \tilde \temperature^{n+1}}{\mathrm d r} \frac{\mathrm d \tilde v}{\mathrm d %
    r}r^2\,\intd{r}  %
  = 4\pi\int_0^{\rmax} \beta(\tilde \enthalpydensity^n)\tilde v r^2\,\intd{r}
\end{multline}
pour toute fonction $\tilde v:[0,\rmax]\to\mathbb R$, $\tilde v(\rmax)
= 0$.

Dans le deuxième cas, la formulation faible de l'équation
(\ref{eq:weak-form-cart-coord}) en coordonnées sphériques consiste à
chercher une fonction $\tilde \temperature^{n+1}:[0,\rmax] \to \mathbb
R$, telle que:
\begin{multline}\label{eq:weak-form-spher-coord-neumann}
  4\pi\int_0^{\rmax} \tilde \temperature^{n+1}\tilde v r^2\,\intd{r}
  + \frac{4\pi\tau}{\mu}\int_0^{\rmax} \frac{\mathrm d %
    \tilde \temperature^{n+1}}{\mathrm d r} \frac{\mathrm d \tilde v}{\mathrm d %
    r}r^2\,\intd{r} \\
  - 4\pi\tilde\temperature^{n+1}_\mathrm{N}(\rmax)\tilde v(\max) %
  = 4\pi\int_0^{\rmax} \beta(\tilde \enthalpydensity^n)\tilde v r^2\,\intd{r},
\end{multline}
pour toute fonction $\tilde v:[0,\rmax]\to\mathbb R$.

\paragraph{Discrétisation en espace}
On considère une subdivision uniforme de l'intervalle $[0, \rmax]$, et
on note $\delta$ taille des éléments de la subdivision. Pour
discrétiser les problèmes faibles
(\ref{eq:weak-form-spher-coord-dirichlet}),
(\ref{eq:weak-form-spher-coord-neumann}) on utilise une méthode
éléments finis Lagrange, continue et linéaire par morceau. Les
intégrales qui interviennent dans les expressions
(\ref{eq:weak-form-spher-coord-dirichlet}),
(\ref{eq:weak-form-spher-coord-neumann}) sont approchées numériquement
par une formule de quadrature de Gauss à 3 points.


%%On donne maintenant la discrétisation du problème faible
%%(\ref{eq:weak-form-spher-coord}) par une méthode de Galerkin. Soit un
%%réel $\delta$ tel que $0 < \delta < \rmax$, et une subdivision
%%$\mathcal T_\delta$ de l'intervalle $[0, \rmax]$, telle que pour tout
%%élément $K\in\mathcal T_\delta$ son diamètre $\diam(K)$ soit borné par
%%$\delta$.
%%
%%On définit l'espace éléments finis
%%\begin{equation}
%%V_\delta = \cparent{v \in C^0(0, \rmax)\mid v\vert_K \in \mathbb
%%  P_1(K)\ \forall K\in\mathcal T_h},
%%\end{equation}
%%où $\mathbb P_1(K)$ est l'espace des polynômes de degré 1 sur
%%l'intervalle $K$.
%%
%%Pour tout $n \leq N$, on note $\tilde \temperature_\delta^{n+1} \in
%%V_\delta$ une approximation de la fonction $\tilde \temperature_\delta^{n+1}$.
%%L'approximation de Galerkin du problème faible (\ref{eq:weak-form-spher-coord})
%%consiste à chercher une fonction $\tilde \temperature_\delta^{n+1} \in
%%V_\delta$ telle que la relation
%%\begin{multline}\label{eq:galerkin-weak-form-spher-coord}
%%  4\pi\int_0^{\rmax} \tilde \temperature_\delta^{n+1}\tilde v_\delta r^2\,\intd{r}
%%  + \frac{4\pi\tau}{\mu}\int_0^{\rmax} \frac{\partial %
%%    \tilde \temperature_\delta^{n+1}}{\partial r} \frac{\partial \tilde v_\delta}{\partial %
%%    r}r^2\,\intd{r} \\
%%  - \frac{\abs{\Gamma_N}}{\rmax^2}\tilde\temperature^{n+1}_\mathrm{N}(\rmax)\tilde v_\delta(\rmax) %
%%  = 4\pi\int_0^{\rmax} \beta(\tilde \enthalpydensity_\delta^n)\tilde v_\delta r^2\,\intd{r},
%%\end{multline}
%%soit vérifiée pour tout $v_\delta \in V_\delta$.

\paragraph{Un test exacte du problème de Stefan à symétrie plane}
Un certain nombre de solutions exactes au problème de Stefan
classique sont connues. On décrit à présent l'une d'elles, découverte en
premier par J. Neumann. Cette solution a l'avantage de correspondre à
une situation physique que l'on peut facilement interpréter.

On considère le problème de Stefan classique formé par les équations
(\ref{eq:heat-solid-phase})-(\ref{eq:heat-liquid-phase}), et on fixe
les données de la manière suivante. On fixe
$\electrolytehc(\temperature) = 1$ et
$\electrolytetdiff(\temperature)=1$ $\forall\temperature \in \mathbb
R$, $\electrolytedensity = 1$, $\fusionenthalpy = 1$ et $\tliq =
0$. On s'intéresse à la température dans un matériau qui occupe la
demi-droite positive, c'est-à-dire que $\Omega = \rplus$.

On choisit la condition initiale suivante pour la température
$\temperature$:
\begin{equation}
  \temperature(0, x) = 0, \quad \forall x\in\rplus,
\end{equation}
et la condition aux limites de Dirichlet sur le bord $\Gamma_\mathrm{D} =
\cparent{0}$:
\begin{equation}
  \temperature(t, 0) = -1, \quad \forall t > 0.
\end{equation}

On note $X(t) > 0$ la position du front de solidification à l'instant
$t$. Dans ces conditions, on peut montrer \cite{HillStefanProblems}
par un calcul algébrique que la solution des équations
(\ref{eq:heat-solid-phase})-(\ref{eq:stefan-condition}) s'écrit:
\begin{align}
  & X(t) = \sqrt{2\gamma t},& \forall t > 0,\label{eq:neumann-sol-frontier}\\
  & \temperature(t, x) = -\gamma\int_{x / \sqrt{2\gamma
      t}}^1\exp\parent{\frac{\gamma(1 - \xi^2)}{2}}\, \intd{\xi},%
  & \forall (t, x) \in [0,\infty)\times[0,X(t)),\label{eq:neumann-sol-solid-phase}\\
    & \temperature(t, x) = 0,
    & \forall (t, x) \in [0,\infty)\times[X(t), \infty),\label{eq:neumann-sol-liquid-phase}
\end{align}
où on a noté $\gamma$ la constante réelle définie comme la solution de
l'équation transcendante:
\begin{equation}
  \gamma \int_0^1\exp\parent{\frac{\gamma(1 - \xi)^2}{2}}\,\intd{\xi}
  = 1.
\end{equation}

On trouvera les détails de la dérivation de cette solution, entre
autres, dans l'ouvrage de J. Hill \cite{HillStefanProblems}.

On calcul une approximation numérique de $\gamma$ à l'aide d'une
itération de Newton, implémentée avec le logiciel MatLAB. On obtient
\begin{equation}\label{eq:gamma}
 %\gamma =\num{0.768955338463582}.
  \gamma =\num{0.768955}.
\end{equation}

La solution
(\ref{eq:neumann-sol-solid-phase})-(\ref{eq:neumann-sol-liquid-phase})
pour la température $\temperature$ s'écrit de manière explicite
en vue de son évaluation numérique sous la forme suivante:
\begin{equation}\label{eq:neumann-sol}
  \temperature(t, x) = \left\{
  \begin{array}{ll}
    -\exp\parent{\frac{\gamma}{2}}\sqrt{\frac{\pi\gamma}{2}} %
    \parent{\erf{\frac{\gamma}{2}} - \erf{\frac{x}{2\sqrt{t}}}}, %
    & \text{si } x \leq \sqrt{2\gamma t},\\
    0 %
    & \text{sinon,}
  \end{array}
  \right.
\end{equation}
où la fonction $\erf:\mathbb R\to(-1,1)$ est la fonction d'erreur
standard définie par:
\begin{equation}
  \erf(x) = \frac{1}{\sqrt \pi}\int_0^x \exp\parent{-s^2}\,\intd{s}.
\end{equation}

La solution exacte (\ref{eq:neumann-sol}) est représentée sur la
figure \ref{fig:neumann-sol} à l'instant $t = 0.5$, avec $\gamma$
donné par la relation (\ref{eq:gamma}).

\begin{figure}
  \begin{center}
    \input{../media/particles/remelt/neumann-exact.tex}
    \caption{Solution exacte de Neumann du problème de Stefan classique
      (\ref{eq:heat-solid-phase})-(\ref{eq:stefan-condition}), évaluée
      à $t = 0.5$ sur l'intervalle $[0,1]\subset \rplus$.}
    \label{fig:neumann-sol}
  \end{center}
\end{figure}

D'un point de vue physique, la solution exacte de Neumann correspond à
la situation suivante. Un matériau, qui présente une transition entre
les phases solide et liquide à $\tliq = 0$, occupe le demi espace
$\cparent{(x_1, x_2, x_3)\in \mathbb R^3 \mid x_1 > 0}$. Ce matériau
est initialement dans l'état liquide à la température $\temperature =
\tliq$. Au temps initial, on le met en contact sur le bord
$\cparent{(x_1, x_2, x_3)\in\mathbb R^3 \mid x_1 = 0}$ avec un
réservoir thermique à température constante $\temperature = -1$. Au
cours de l'évolution temporelle, un front de transition de phase, de
liquide à solide, se propage dans le matériau. Pour des raisons de
symétrie, le front de transition reste en tout temps parallèle au
bord $\cparent{(x_1, x_2, x_3)\in\mathbb R^3 \mid x_1 = 0}$.

On utilisera cette solution exacte dans la suite pour valider le schéma de
discrétisation des équations
(\ref{eq:heat-one-phase})-(\ref{eq:heat-one-phase-neumann}), que l'on
décrit maintenant.

\paragraph{Validation numérique}
Pour valider l'implémentation du schéma numérique
(\ref{eq:chernoff-heat})-(\ref{eq:chernoff-update}), on évalue la
convergence de l'erreur entre la solution exacte définie par la
relation (\ref{eq:neumann-sol}) et $\temperature^N_\delta$,
l'approximation de la température à l'instant $T$. On fixe $\mu =
L_\beta = 1$. On choisit $\Omega = [0, 1] \subset \rplus$ et $T =
0.5$. On impose des conditions aux limites de Dirichlet sur le bord de
$\Omega$, \ie, $\Gamma_\mathrm{D} = \cparent{0, 1}$. On se donne
$\temperature_\mathrm{D}(0) = -1$ et $\temperature_\mathrm{D}(1) =
0$. On choisit le pas de temps $\tau$ dans l'intervalle
$[\num{3.9e-5}, \num{5e-3}]$, et $\delta = O(\tau)$.

\begin{figure}
  \begin{center}
    \input{../media/particles/remelt/neumann-convergence-h.tex}
    \caption{Erreur $L^2$ entre la solution exacte de Neumann et
      l'approximation numérique $\temperature^N_\delta$}
    \label{fig:neumann-convergence}
  \end{center}
\end{figure}

On constate sur la figure \ref{fig:neumann-convergence} que l'erreur
$L^2$ entre la solution exacte et l'approximation numérique converge
vers 0, avec un ordre approximatif $O(h^{3/4})$.




% application: formation et refonte de bain gele autour d'une
% particule.
\paragraph{Formation de gel autour d'une particule}
Dans cette partie, on applique la méthode numérique
(\ref{eq:chernoff-heat})-(\ref{eq:chernoff-neumann}) au calcul de
la formation de gel autour d'une particule de bain gelé.

On donne dans le tableau \ref{tab:freeze-physical-parameters} la
valeur des différents paramètres physique liés aux propriétés
thermiques du bain électrolytique.

\begin{table}
  \begin{center}
    \caption{Paramètres physiques qui interviennent dans le
      phénomène de formation de gel autour de particules.}
    \label{tab:freeze-physical-parameters}
    \begin{tabularx}{\textwidth}{@{}lllX@{}}
      \toprule
      Quantité              & Valeur       & Unité                                       & Description \\
      \midrule
      $\electrolytedensity$ & \num{2130}    & \si{\kg\per\cubic\meter}                    & Masse volumique du bain électrolytique \\
      $\electrolyteshc$     & \num{1403}    & \si{\joule\per\kilo\gram\per\kelvin}        & Chaleur spécifique de l'électrolyte dans la phase solide \\
      $\electrolytelhc$     & \num{1861.3}  & \si{\joule\per\kilo\gram\per\kelvin}        & Chaleur spécifique de l'électrolyte dans la phase liquide \\
      $\fusionenthalpy$     & \num{5.508e5} & \si{\joule\per\kilo\gram}                   & Chaleur latente de transition de phase solide-liquide \\
      $\tinj$               & \num{423.15}  & \si{\kelvin}                                & Température de la particule de bain gelé au moment de l'injection \\
      $\tliq$               & \num{1223.15}  & \si{\kelvin}                                & Température du liquidus de l'électrolyte \\
      $\electrolytetdiff$   & \num{2}     & \si{\joule\per\second\per\meter\per\kelvin} & Conductivité thermique de l'électrolyte \\
      \bottomrule
    \end{tabularx}
\end{center}
\end{table}

Puisqu'on s'intéresse à une particule sphérique, on fait l'hypothèse
que les données du problème présentent une symétrie sphérique. Ainsi,
on décrite l'ensemble des données en fonction de la distance à
l'origine $r$. De plus, on cherche la température $\temperature$ dans
l'électrolyte en fonction de la coordonnée $r$. Par abus de notation
et pour éviter de surcharger les notation, on réutilise les mêmes
symboles, mais explicitant la coordonnée $r$.

\begin{figure}[h]
  \begin{center}
    \input{../media/particles/temperature/temperature.tex}
    \caption{Température initiale du système formé par la particule de
      bain gelé placée à l'origine du système de coordonnées, et du
      bain électrolytique environnant.}
    \label{fig:particle-initial-temperature}
  \end{center}
\end{figure}

Soit $R_p$ le rayon de la particule placée à l'origine du système de
coordonnées et soit $\tinj\in\mathbb R$ la température à laquelle se
trouve les particules d'alumine au moment de leur injection dans la
cuve. Soit $\telectrolyte$ la température du bain électrolytique. La
condition initiale du système formé par la particule et le bain
environnant est définie par:
\begin{equation}
  \tinit(r) = \left\{
  \begin{array}{ll}
    \tinj & \text{ si } r < R_p,\\
    \telectrolyte & \text{ si } r \geq R_p,\\
  \end{array}
  \right.\quad \forall r\in \rplus .\label{eq:initial-temperature}
\end{equation}

La figure \ref{fig:particle-initial-temperature} représente la
température initiale au voisinage de la particule. En dehors de la
particule, la température du bain est suffisante pour que celui-ci
soit dans la phase liquide. Cependant, on suppose que le bain liquide
est au repos en tout temps.

On note $R_f$ la distance entre l'origine et la position du front de
solidification, définie par la relation:
\begin{equation}
\beta(\enthalpydensityr(t, R_f(t))) = \tliq.
\end{equation}
L'épaisseur de la couche de bain solidifiée $R_g$ est définie par la
relation:
\begin{equation}
R_g(t) = R_f(t) - R_p.
\end{equation}
On définit alors le temps de latence $\tlat(R_p) > 0$, le temps
nécessaire à ce que l'épaisseur de bain solidifié atteigne à nouveau
zéro:
\begin{equation}
  R_g(\tlat).
\end{equation}

\begin{figure}
\begin{center}
  \input{../media/particles/remelt/frozen-layer-sur2-5.tex}
  \input{../media/particles/remelt/frozen-layer-sur5.tex}
  \input{../media/particles/remelt/frozen-layer-sur10.tex}
  \caption{Évolution du rayon de la sphère de bain gelé pour des
    température de surchauffe de \num{2.5}\si{\kelvin},
    \num{5}\si{\kelvin} et \num{10}\si{\kelvin} et des particules de
    rayons initiaux $r_0 = $\num{40}\si{\micro\meter},
    \num{60}\si{\micro\meter} et \num{80}\si{\micro\meter}.}
  \label{fig:freeze-radius}
\end{center}
\end{figure}
On considère une particule de bain solidifié de rayon initial $R_0 =$
\num{40}\si{\micro\meter}, \num{60}\si{\micro\meter} et
\num{80}\si{\micro\meter}. La surchauffe du bain électrolytique est
définie ici comme la différence entre la température initiale du bain
$\telectrolyte$ et la température de liquidus $\tliq$. La figure
\ref{fig:freeze-radius} présente l'évolution du rayon de la particule
pour trois surchauffes différentes du bain électrolytique environnant.

On constate que le temps nécessaire à refondre le bain gelé
diminue avec la surchauffe. De même, le temps de refonte diminue avec
la taille de la particule.

La température initiale de la particule est $T_\text{inj} =
423.15\si{\kelvin}$. Dans le cas le plus défavorable où $T -
T_\text{Liq} = 2.5\si{\kelvin}$ et $r_0 = 80\si{\micro\meter}$, le
temps nécessaire pour refondre entièrement la couche de gel est de
l'ordre de 120\si{\milli\second}.

Dans les calculs présentés ici, on a fait plusieurs hypothèses
simplificatrices. On a supposé que le fluide environnant est au
repos, ce qui n'est certainement pas le cas dans une cuve
d'électrolyse industrielle. Les forces de Lorentz et la formation de
bulles de gaz agitent les fluides, et créent des turbulences qui sont,
entre autres, de l'échelle des particules \cite{Rochat2016}. Une
agitation de l'électrolyte au voisinage d'une particule accélère le
transport de l'énergie thermique, et tend à accélérer la refonte du
bain gelé.

Pour simplifier le modèle, nous avons étudié la formation de gel
autour d'une particule sphérique de bain solidifiée. Bien entendu,
dans une cuve d'électrolyse industrielle on injecte des particules
particules d'alumine à basse température, plutôt que des particule de
bain gelé. Cependant, les propriétés thermiques des deux systèmes sont
proches, ce qui justifie cette approximation.

Lors de l'injection d'une dose de particules d'alumine, l'hypothèse
d'une particule isolée dans un bain infini au repos n'est plus
vérifiée. Les différentes particules qui constituent la dose
interagissent thermiquement entre elles par l'intermédiaire du bain
environnant. Ce comportement explique la raison pour laquelle
l'hypothèse de particules isolée mène à des temps typique de
formation et refonte de gel largement inférieurs aux valeurs
recommandées par exemple dans le travail de V. Dassylva-Raymond \cite{Dassylva2015}.

Selon la recommandation de V. Dassylva-Raymond \cite{Dassylva2015}, on
choisira, dans la suite, pour le temps de latence d'une dose de
particules injectées dans le bain une valeur uniforme $\tlat =
1\si{\second}$, indépendante du rayon.
